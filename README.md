# Excel to MariaDB Data Import Script
## 소개
이 프로젝트는 엑셀 파일에서 데이터를 읽어와 MariaDB 데이터베이스에 저장하는 파이썬 스크립트입니다.<br>
엑셀 파일을 읽고, 정보를 추출해 데이터베이스에 삽입힙니다. 데이터베이스 형식은 "241114 전남e학습터 검색시스템 테이블정의서-v0.4"에 명시되어있습니다. 

## 요구사항
이 스크립트를 사용하려면 아래의 라이브러리를 설치해야 합니다:
```bash
pip install mariadb pandas openpyxl
```

## 사용법
1. **환경 설정**: MariaDB 데이터베이스에 접근할 수 있는 설정이 필요합니다.
   - `connect()` 함수는 테이블정의서의 기본값으로 설정되어있습니다. host와 port를 적절하게 수정해주세요. 

2. **엑셀 파일 경로 설정**:
   - `main()` 함수 내부에 있는 `excel_file_path` 변수에 엑셀 파일의 경로를 지정해야 합니다.
   - 엑셀 파일의 경로를 지정하려면 파일을 **우클릭**한 후 **경로로 복사**를 선택하세요. 예시: `C:\Users\사용자명\Desktop\test.xlsx`

3. **스크립트 실행**:
   - 아래 명령어로 스크립트를 실행하세요.   
   ```bash
   python main.py
   ```

4. **데이터 삽입 과정**:
   - 엑셀 파일에서 읽은 데이터는 `extract_year_semester()` 함수에서 연도와 학기를 추출한 후, `insert_data()` 함수를 통해 데이터베이스에 삽입됩니다.


## 주의사항 (Notes)
- 엑셀 파일의 첫 번째 행은 제목이므로 스크립트에서 이를 건너뛰고 실제 데이터를 읽도록 설정되어 있습니다.
- `extract_year_semester()` 함수에서 엑셀 파일의 첫 번째 셀을 참조하여 연도와 학기를 추출합니다. 만약 해당 셀에 유효한 정보가 없다면 에러가 발생합니다.

## 예시 (Example)
엑셀 파일은 아래와 같은 형식을 가지고 있어야 합니다:

| 연번 | 청번 | 청명  | 소속      | 성명 | 나이스 개인번호 | 생년월일-성별 | 영역 | 시작일     | 종료일     | 비고 |
|------|------|-------|-----------|------|---------------|--------------|------|-----------|-----------|------|
| 1    | 101  | 목포   | OO초등학교 | 홍길동 | Q123456789    | 780221-1     | 과학  | 20240301   | 20240831   |      |

## 오류 처리 (Error Handling)
- **엑셀 파일 경로 오류**: 엑셀 파일 경로가 잘못되었거나 파일이 없을 경우, `FileNotFoundError`가 발생하며 오류 메시지를 출력합니다.
- **연도/학기 추출 실패**: 엑셀 파일의 첫 번째 셀에서 연도와 학기를 추출할 수 없으면 `ValueError`가 발생합니다.

